{% extends "main/header.html" %}


{% block content %}
<a href="create_board" class="btn-floating btn-large waves-effect waves-light black"><i class="material-icons">+</i></a>
<div class="row">


    <div class="col s9">
        {% for b in boards %}
        <div class="col s12 m6 ">
            <a href="{{b.board_id}}", style="color:#000">
                <div class="card hoverable">
                    <div class="cart-content">
                        <div class="card-title">{{b.name}}</div>
                        <div id="{{b.board_id}}" style="height: 400px">
                            <script>
                                var div = document.getElementById("{{b.board_id}}");
                                var rect = div.getBoundingClientRect();
                                var x = rect.left;
                                var y = rect.top;
                                var width = rect.right - x;
                                var height = rect.bottom - y;
                                var columns = {{b.columns}};
                                var size = width < height ? width : height;
                                xOffset = x + (width - size)/2;

                                var pa = Raphael(div);
                                pa.setViewBox(0, 0, size, size, true);
                                pa.canvas.setAttribute('preserveAspectRatio', 'none');

                                var cellSize = size / columns;
                                    for(j=0; j< columns; j++) {
                                        var path=' \"M';
                                        path += ("0 ");
                                        path += String(j*cellSize) + "L" + String(columns*cellSize) + " " + String(j*cellSize);
                                        line = pa.path(path);

                                        var path=' \"M';
                                        path += (String(j * cellSize));
                                        path += " 0" + "L" + String(j*cellSize) + " " + String(columns*cellSize);
                                        line = pa.path(path);
                                    }
                                obstacles = {{b.obstacles_json|safe}};
                                obstacles.forEach( function (obs) {
                                    type = obs['type'];
                                    x = obs['x'];
                                    y = obs['y'];
                                    var c;
                                    if(type == "circle") {
                                        c = pa.circle(x,y,cellSize);
                                    } else {
                                        c = pa.rect(x,y,2*cellSize, 2*cellSize);
                                    }
                                    c.attr({"fill": "#808080", "fill-opacity": 0.5, "stroke-width":3 });
                                });
                                lid = pa.rect({{b.lidar_x}}, {{b.lidar_y}}, 2*cellSize, 2*cellSize);
                                lid.attr({"fill": "#f00", "fill-opacity": 0.5, "stroke-width":3 });



                            </script>
                        </div>
                    </div>
                </div>
            </a>
        </div>
        {% endfor %}
    </div>

</div>

{% endblock %}

